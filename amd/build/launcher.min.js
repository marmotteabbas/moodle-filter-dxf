define(["jquery","filter_dxf/three","filter_dxf/dxf-parser","filter_dxf/three-dxf"],function(a,b,c,d){var e=document.getElementById("file-progress-bar-1"),f=a(".progress"),g=1,h=[],i="",j=function(a){var j=a.target;if(j.error)return alert("error onloadend!?");e.style.width="100%",e.textContent="100%",setTimeout(function(){f.removeClass("loading")},2e3);var k,l=new c,m=l.parseSync(j.result),o=new b.FontLoader;o.load(i+"/filter/dxf/fonts/helvetiker_regular.typeface.json",function(a){k=a,d.Viewer(m,document.getElementById("cad-view-"+g),400,400,k),g++,h.length>=g&&n()})},k=function(a){if(a.lengthComputable){var b=Math.round(a.loaded/a.total*100);b<100&&(e.style.width=b+"%",e.textContent=b+"%")}},l=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case a.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case a.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}},m=function(){alert("Aborted read!")},n=function(){e=document.getElementById("file-progress-bar-"+g);var a=new XMLHttpRequest;a.open("GET",h[g-1],!0),a.responseType="blob",a.onload=function(){if(200==this.status){var a=this.response;e.style.width="0%",e.textContent="0%";var b=new File([a],h[g-1],{type:"application/octet-binary",lastModified:Date.now()}),c=[];c.push("<li><strong>",encodeURI(b.name),"</strong> (",b.type||"n/a",") - ",b.size," bytes, last modified: ",b.lastModifiedDate?b.lastModifiedDate.toLocaleDateString():"n/a","</li>"),f.addClass("loading");var d=new FileReader;d.onprogress=k,d.onloadend=j,d.onabort=m,d.onerror=l,d.readAsText(b)}},a.send()};return{init:function(a,b){i=b,h=a,n()}}});